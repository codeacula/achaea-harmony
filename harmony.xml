<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE MudletPackage>
<MudletPackage version="1.000">
    <AliasPackage>
        <AliasGroup isActive="yes" isFolder="yes">
            <name>Harmony</name>
            <script></script>
            <command></command>
            <packageName></packageName>
            <regex></regex>
            <AliasGroup isActive="no" isFolder="yes">
                <name>Combat</name>
                <script></script>
                <command></command>
                <packageName></packageName>
                <regex></regex>
            </AliasGroup>
            <AliasGroup isActive="yes" isFolder="yes">
                <name>Hunting</name>
                <script></script>
                <command></command>
                <packageName></packageName>
                <regex></regex>
                <Alias isActive="yes" isFolder="no">
                    <name>Set theshold</name>
                    <script>if Harmony then
	Harmony.hunting.setThreshold(matches[2])
end</script>
                    <command></command>
                    <packageName></packageName>
                    <regex>^har threshold (\d+)$</regex>
                </Alias>
                <Alias isActive="yes" isFolder="no">
                    <name>Toggle autoattack</name>
                    <script>if Harmony then
	Harmony.hunting.toggleAutoAttack()
end</script>
                    <command></command>
                    <packageName></packageName>
                    <regex>^har autoattack$</regex>
                </Alias>
            </AliasGroup>
            <AliasGroup isActive="no" isFolder="yes">
                <name>Refills</name>
                <script></script>
                <command></command>
                <packageName></packageName>
                <regex></regex>
            </AliasGroup>
            <AliasGroup isActive="yes" isFolder="yes">
                <name>Mapping</name>
                <script></script>
                <command></command>
                <packageName></packageName>
                <regex></regex>
                <Alias isActive="yes" isFolder="no">
                    <name>toggles exploring</name>
                    <script>Harmony.mapping.toggleExploring()</script>
                    <command></command>
                    <packageName></packageName>
                    <regex>^har exp$</regex>
                </Alias>
                <Alias isActive="yes" isFolder="no">
                    <name>check unexplored rooms in area</name>
                    <script>Harmony.mapping.printUnexploredRooms()</script>
                    <command></command>
                    <packageName></packageName>
                    <regex>^har unexplored$</regex>
                </Alias>
                <Alias isActive="yes" isFolder="no">
                    <name>toggles lock</name>
                    <script>Harmony.mapping.lockRoom(matches[2])</script>
                    <command></command>
                    <packageName></packageName>
                    <regex>^harmony locked (.*)$</regex>
                </Alias>
                <Alias isActive="yes" isFolder="no">
                    <name>explore next room</name>
                    <script>Harmony.mapping.gotoNextRoom()</script>
                    <command></command>
                    <packageName></packageName>
                    <regex>^har er$</regex>
                </Alias>
                <Alias isActive="yes" isFolder="no">
                    <name>toggle autoexplor</name>
                    <script>Harmony.mapping.toggleAutoexplore()</script>
                    <command></command>
                    <packageName></packageName>
                    <regex>^har autoexp$</regex>
                </Alias>
                <Alias isActive="yes" isFolder="no">
                    <name>hides room</name>
                    <script>setRoomArea(matches[2], -1)</script>
                    <command></command>
                    <packageName></packageName>
                    <regex>^har hide (\d+)$</regex>
                </Alias>
                <Alias isActive="yes" isFolder="no">
                    <name>Mark current room</name>
                    <script>Harmony.mapping.markCurrentRoom(matches[2])</script>
                    <command></command>
                    <packageName></packageName>
                    <regex>^room mark (\w+)$</regex>
                </Alias>
            </AliasGroup>
            <Alias isActive="yes" isFolder="no">
                <name>Reset Harmony</name>
                <script>Harmony = nil

-- Loads the script
local _sep
if string.char(getMudletHomeDir():byte()) == &quot;/&quot; then 
	_sep = &quot;/&quot; 
else
	_sep = &quot;\\&quot; 
end

local scriptFile = getMudletHomeDir() .. _sep .. &quot;harmony&quot; .. _sep ..&quot;harmony.lua&quot;
dofile(scriptFile)</script>
                <command></command>
                <packageName></packageName>
                <regex>^har reset$</regex>
            </Alias>
            <Alias isActive="yes" isFolder="no">
                <name>Show commands</name>
                <script>local commandGroups = {} -- Because I want to sort by category
local commandGroupCache = {} -- Because I want easy lookups

-- Because I don't want to write them in table structure manually
local addCommand = function(group, comm, desc)
	if not commandGroupCache[group] then
		local newGroup = {
			name = group,
			commands = {}
		}

		table.insert(commandGroups, newGroup)
		commandGroupCache[group] = newGroup
	end

	table.insert(commandGroupCache[group].commands, { command = comm, desc = desc })
end

addCommand(&quot;bashing&quot;, &quot;har autoattack&quot;, &quot;Toggles on/off auto attack&quot;)
addCommand(&quot;bashing&quot;, &quot;har threshold &lt;number&gt;&quot;, &quot;If you enter a room with this many mobs or more, won't autoattack&quot;)
addCommand(&quot;mapping&quot;, &quot;har exp&quot;, &quot;Toggles on/off marking rooms as explored when you visit them&quot;)
addCommand(&quot;mapping&quot;, &quot;har autoexp&quot;, &quot;Toggles on/off auto exploration&quot;)
addCommand(&quot;mapping&quot;, &quot;har unexplored&quot;, &quot;Shows all known unexplored rooms, even if they're locked&quot;)
addCommand(&quot;mapping&quot;, &quot;har locked &lt;roomid&gt;&quot;, &quot;Marks the provided room id as locked&quot;)
addCommand(&quot;mapping&quot;, &quot;har hide &lt;roomid&gt;&quot;, &quot;Puts the provided room id in area -1, effectively hiding it&quot;)
addCommand(&quot;mapping&quot;, &quot;har er&quot;, &quot;Looks for the first unvisited, unlocked room by id and tells the mapper to go there&quot;)
addCommand(&quot;system&quot;, &quot;har reset&quot;, &quot;Resets and reruns the harmony scripts&quot;)
addCommand(&quot;ui&quot;, &quot;har map&quot;, &quot;Turns the map on/off&quot;)

table.sort(commandGroups, function(t1, t2) return t1.name &lt;= t2.name end)
if Harmony then
	Harmony.say(&quot;Here's the currently available commands&quot;)

	for _, group in ipairs(commandGroups) do
		cecho(string.format(&quot;&lt;HotPink&gt;Category: &lt;ForestGreen&gt;%s\n&quot;, group.name))
		
		table.sort(group.commands, function(t1, t2) return t1.command &lt;= t2.command end)

		for _, command in ipairs(group.commands) do
			cecho(string.format(&quot;&lt;yellow&gt;%s&lt;white&gt; - &lt;pink&gt;%s\n&quot;, command.command, command.desc))
		end
		cecho(&quot;\n&quot;)
	end
end

</script>
                <command></command>
                <packageName></packageName>
                <regex>^har$</regex>
            </Alias>
        </AliasGroup>
    </AliasPackage>
    <KeyPackage>
        <KeyGroup isActive="yes" isFolder="yes">
            <name>Harmony</name>
            <packageName></packageName>
            <script></script>
            <command></command>
            <keyCode>-1</keyCode>
            <keyModifier>-1</keyModifier>
            <KeyGroup isActive="yes" isFolder="yes">
                <name>Keypad</name>
                <packageName></packageName>
                <script></script>
                <command></command>
                <keyCode>-1</keyCode>
                <keyModifier>-1</keyModifier>
                <Key isActive="yes" isFolder="no">
                    <name>0</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;0&quot;)
else
    send(&quot;map&quot;)
end</script>
                    <command></command>
                    <keyCode>48</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>1</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;1&quot;)
else
    send(&quot;sw&quot;)
end</script>
                    <command></command>
                    <keyCode>49</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>2</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;2&quot;)
else
    send(&quot;s&quot;)
end</script>
                    <command></command>
                    <keyCode>50</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>3</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;3&quot;)
else
    send(&quot;se&quot;)
end</script>
                    <command></command>
                    <keyCode>51</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>4</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;4&quot;)
else
    send(&quot;w&quot;)
end</script>
                    <command></command>
                    <keyCode>52</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>5</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;5&quot;)
else
    send(&quot;look&quot;)
end</script>
                    <command></command>
                    <keyCode>53</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>6</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;6&quot;)
else
    send(&quot;e&quot;)
end</script>
                    <command></command>
                    <keyCode>54</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>7</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;7&quot;)
else
    send(&quot;ne&quot;)
end</script>
                    <command></command>
                    <keyCode>55</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>8</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;8&quot;)
else
    send(&quot;n&quot;)
end</script>
                    <command></command>
                    <keyCode>56</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>9</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;9&quot;)
else
    send(&quot;ne&quot;)
end</script>
                    <command></command>
                    <keyCode>57</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>/</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;/&quot;)
else
    send(&quot;in&quot;)
end</script>
                    <command></command>
                    <keyCode>47</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>*</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;*&quot;)
else
    send(&quot;out&quot;)
end</script>
                    <command></command>
                    <keyCode>42</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>-</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;-&quot;)
else
    send(&quot;up&quot;)
end</script>
                    <command></command>
                    <keyCode>45</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>+</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;+&quot;)
else
    send(&quot;down&quot;)
end</script>
                    <command></command>
                    <keyCode>43</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
                <Key isActive="yes" isFolder="no">
                    <name>.</name>
                    <packageName></packageName>
                    <script>if Harmony then
    Harmony.keypad.processKey(&quot;.&quot;)
else
    send(&quot;ih&quot;)
end</script>
                    <command></command>
                    <keyCode>46</keyCode>
                    <keyModifier>536870912</keyModifier>
                </Key>
            </KeyGroup>
        </KeyGroup>
    </KeyPackage>
    <ScriptPackage>
        <ScriptGroup isActive="yes" isFolder="yes">
            <name>Harmony</name>
            <packageName></packageName>
            <script></script>
            <eventHandlerList/>
            <Script isActive="yes" isFolder="no">
                <name>load</name>
                <packageName></packageName>
                <script>-- Loads the script
local _sep
if string.char(getMudletHomeDir():byte()) == &quot;/&quot; then 
    _sep = &quot;/&quot; 
else
    _sep = &quot;\\&quot; 
end

local scriptFile = getMudletHomeDir() .. _sep .. &quot;harmony&quot; .. _sep ..&quot;harmony.lua&quot;
dofile(scriptFile)</script>
                <eventHandlerList/>
            </Script>
            <ScriptGroup isActive="yes" isFolder="yes">
                <name>Callbacks</name>
                <packageName></packageName>
                <script></script>
                <eventHandlerList/>
                <Script isActive="yes" isFolder="no">
                    <name>Harmony.hunting.checkAttack</name>
                    <packageName></packageName>
                    <script></script>
                    <eventHandlerList>
                        <string>gmcp.Room.Info</string>
                        <string>keneanung.bashing.targetList.firstChanged</string>
                    </eventHandlerList>
                </Script>
                <Script isActive="yes" isFolder="no">
                    <name>Harmony.mapping.arrived</name>
                    <packageName></packageName>
                    <script>
</script>
                    <eventHandlerList>
                        <string>mmapper arrived</string>
                    </eventHandlerList>
                </Script>
                <Script isActive="yes" isFolder="no">
                    <name>Harmony.mapping.exploreNext</name>
                    <packageName></packageName>
                    <script></script>
                    <eventHandlerList>
                        <string>mmapper arrived</string>
                    </eventHandlerList>
                </Script>
                <Script isActive="yes" isFolder="no">
                    <name>Harmony.hunting.movedRooms</name>
                    <packageName></packageName>
                    <script></script>
                    <eventHandlerList>
                        <string>gmcp.Room.Info</string>
                    </eventHandlerList>
                </Script>
                <Script isActive="yes" isFolder="no">
                    <name>Harmony.mapping.updateRoom</name>
                    <packageName></packageName>
                    <script></script>
                    <eventHandlerList>
                        <string>gmcp.Room.Info</string>
                    </eventHandlerList>
                </Script>
            </ScriptGroup>
        </ScriptGroup>
    </ScriptPackage>
    <TriggerPackage>
        <TriggerGroup isActive="yes" isFolder="yes" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
            <name>Harmony</name>
            <script></script>
            <triggerType>0</triggerType>
            <conditonLineDelta>0</conditonLineDelta>
            <mStayOpen>0</mStayOpen>
            <mCommand></mCommand>
            <packageName></packageName>
            <mFgColor>#ff0000</mFgColor>
            <mBgColor>#ffff00</mBgColor>
            <mSoundFile></mSoundFile>
            <colorTriggerFgColor>#000000</colorTriggerFgColor>
            <colorTriggerBgColor>#000000</colorTriggerBgColor>
            <regexCodeList/>
            <regexCodePropertyList/>
            <TriggerGroup isActive="yes" isFolder="yes" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                <name>Mapping</name>
                <script></script>
                <triggerType>0</triggerType>
                <conditonLineDelta>0</conditonLineDelta>
                <mStayOpen>0</mStayOpen>
                <mCommand></mCommand>
                <packageName></packageName>
                <mFgColor>#ff0000</mFgColor>
                <mBgColor>#ffff00</mBgColor>
                <mSoundFile></mSoundFile>
                <colorTriggerFgColor>#000000</colorTriggerFgColor>
                <colorTriggerBgColor>#000000</colorTriggerBgColor>
                <regexCodeList/>
                <regexCodePropertyList/>
                <Trigger isActive="yes" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                    <name>Room Locked</name>
                    <script>Harmony.mapping.roomLocked()</script>
                    <triggerType>0</triggerType>
                    <conditonLineDelta>0</conditonLineDelta>
                    <mStayOpen>0</mStayOpen>
                    <mCommand></mCommand>
                    <packageName></packageName>
                    <mFgColor>#ff0000</mFgColor>
                    <mBgColor>#ffff00</mBgColor>
                    <mSoundFile></mSoundFile>
                    <colorTriggerFgColor>#000000</colorTriggerFgColor>
                    <colorTriggerBgColor>#000000</colorTriggerBgColor>
                    <regexCodeList>
                        <string>^There is a door in the way, to the .*\.$</string>
                    </regexCodeList>
                    <regexCodePropertyList>
                        <integer>1</integer>
                    </regexCodePropertyList>
                </Trigger>
                <Trigger isActive="yes" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                    <name>Echo</name>
                    <script></script>
                    <triggerType>0</triggerType>
                    <conditonLineDelta>0</conditonLineDelta>
                    <mStayOpen>0</mStayOpen>
                    <mCommand>look</mCommand>
                    <packageName></packageName>
                    <mFgColor>#ff0000</mFgColor>
                    <mBgColor>#ffff00</mBgColor>
                    <mSoundFile></mSoundFile>
                    <colorTriggerFgColor>#000000</colorTriggerFgColor>
                    <colorTriggerBgColor>#000000</colorTriggerBgColor>
                    <regexCodeList>
                        <string>(mapper): We've arrived!</string>
                    </regexCodeList>
                    <regexCodePropertyList>
                        <integer>0</integer>
                    </regexCodePropertyList>
                </Trigger>
            </TriggerGroup>
        </TriggerGroup>
    </TriggerPackage>
</MudletPackage>
